<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title layout:title-pattern="${CONTENT_TITLE} - ITravel">ITravel</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta th:if="${_csrf != null}" name="_csrf" th:content="${_csrf.token}"/>
    <meta th:if="${_csrf != null}" name="_csrf_header" th:content="${_csrf.headerName}"/>


    <!-- Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- Bootstrap -->
    <link th:href="@{/vendor/bootstrap/css/bootstrap.css}" rel="stylesheet">

    <!-- GLightbox -->
    <link th:href="@{/vendor/glightbox/css/glightbox.min.css}" rel="stylesheet">


    <!-- CSS propriu -->
    <link th:href="@{/css/style.css}" rel="stylesheet">

    <style>
        #navmenu a.active { font-weight: 700; opacity: 1 !important; }
        body.scrolled #navmenu a.active { font-weight: 700; opacity: 1 !important; }
    </style>


    <!-- =======================================================
    * Template Name: TravelTime
    * Template URL: https://bootstrapmade.com/traveltime-bootstrap-travel-template/
    * Updated: Jul 28 2025 with Bootstrap v5.3.7
    * Author: BootstrapMade.com
    * License: https://bootstrapmade.com/license/
    ======================================================== -->
</head>
<header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container position-relative d-flex align-items-center justify-content-between">

        <a th:href="@{/Itravel}" class=" logo d-flex align-items-center me-auto me-xl-0">
            <!-- Uncomment the line below if you also wish to use an image logo -->

            <!--                <<img th:src="@{/walpaper/walpaper-image.jpg}" alt="">-->


            <h1 class="sitename">ITravel</h1>
        </a>


        <nav id="navmenu" class="navmenu" >
            <ul>
                <li><a th:href="@{/Itravel}">Acasă</a></li>
                <li><a th:href="@{/About}">Despre</a></li>
                <li><a th:href="@{/destinations}">Destinații</a></li>
                <li sec:authorize="hasRole('User')">
                    <a th:href="@{/Tours}">Tururi</a>
                </li>
                <li sec:authorize="hasRole('User') and !hasAnyRole('Guide')">
                    <a th:href="@{/trips}">Itinerariile mele</a>
                </li>



                <li sec:authorize="hasAnyRole('Admin','Guide')" class="dropdown">
                    <a href="#"><span>Actions</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                    <ul class="custom-dropdown">
                        <!-- Link doar pentru Admin -->
                        <li sec:authorize="hasRole('Admin')">
                            <a th:href="@{/destinations/new}">Creează Destinație</a>
                        </li>

                        <!-- Link doar pentru Guide -->
                        <li sec:authorize="hasRole('Guide')">
                            <a th:href="@{/Itravel/new}">Creează Tur</a>
                        </li>
                    </ul>
                </li>

<!--                <li><a th:href="@{/Contact}" >Contact</a></li>-->
                <!--<li sec:authorize="isAnonymous()">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a>
                </li>-->
                <li class="theme-toggle-li">
                    <button id="themeToggle" class="btn btn-theme" type="button"
                            aria-label="Toggle theme" aria-pressed="false" title="Toggle theme">
                        <i class="bi bi-sun"></i>  <!-- soare când e LIGHT -->
                    </button>
                </li>

            </ul>
            <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>

        <!-- Slotul din dreapta: Login / Meniu utilizator -->
        <div class="right-cta d-flex align-items-center">
            <!-- Când NU ești logat: Login -->
            <a sec:authorize="isAnonymous()"
               href="#"
               class="btn-getstarted"
               data-bs-toggle="modal" data-bs-target="#loginModal">
                Login
            </a>
            <li sec:authorize="isAuthenticated()" class="account-item d-flex align-items-center">

                <div class="avatar-container me-2"
                     data-bs-toggle="modal"
                     data-bs-target="#avatarModal"
                     style="cursor: pointer; position: relative;">

                    <!-- Avatar -->
                    <img th:src="${navbarAvatarUrl}"
                         alt="Avatar"
                         class="avatar"
                         th:classappend="${navbarLevelClass}">

                    <!-- Rama GIF -->
                    <img th:if="${navbarFrameGif != null}"
                         th:src="@{${navbarFrameGif}}"
                         class="avatar-frame">

                    <!-- Badge puncte (doar User) -->
                    <span
                            id="navbar-points"
                            sec:authorize="hasRole('User') and !hasRole('Guide')"
                            class="badge points"
                            th:utext="${navbarPoints} + ' <i class=\'fa-regular fa-money-bill-1\'></i>'">
</span>


                    <!-- Badge nivel -->

                    <!-- Badge nivel (doar dacă NU e Admin) -->
                    <span class="badge level"
                          sec:authorize="isAuthenticated() and !hasRole('Admin')"
                          th:text="'Lvl ' + ${navbarLevel}"></span>


                    <!-- Badge User -->
                    <span class="badge role User"
                          sec:authorize="hasRole('User') and !hasRole('Guide')">
        <i class="bi bi-person-fill"></i> User
    </span>

                    <!-- Badge Guide -->
                    <span class="badge role Guide"
                          sec:authorize="hasRole('Guide')">
        <i class="bi bi-geo-alt-fill"></i> Guide
    </span>
                    <!-- Badge Admin -->
                    <span class="badge role Admin" sec:authorize="hasRole('Admin')">
    <i class="bi bi-shield-fill"></i> Admin
</span>

                </div>



                <!-- Toggle Cont -->
                <a href="#" class="account-toggle d-flex align-items-center">
    <span class="account-name">
        <b sec:authentication="name"></b>
    </span>
                    <i class="bi bi-chevron-down toggle-dropdown ms-1"></i>
                </a>

                <!-- Meniu -->
                <div class="account-menu">
                    <ul>
                        <li><a th:href="@{/user_profile}">Profilul meu</a></li>
                        <li><a th:href="@{/logout}">Logout</a></li>
                    </ul>
                </div>

        </div>
    </div>
</header>
<!-- Fragmentul pentru conținutul paginii copil -->
<div layout:fragment="content"></div>

<!-- Footer -->
<footer id="footer" class="footer position-relative dark-background">

    <div class="container">
        <div class="row gy-5">

            <div class="col-lg-4">
                <div class="footer-content">
                    <a href="index.html" class="logo d-flex align-items-center mb-4">
                        <span class="sitename">ITravel</span>
                    </a>
                    <p class="mb-4">Oferim experiențe de călătorie de neuitat și servicii personalizate pentru fiecare aventură. Echipa noastră este dedicată confortului și siguranței tale.</p>

                    <div class="newsletter-form">
                        <h5>Abonează-te</h5>
                        <form action="forms/newsletter.php" method="post" class="php-email-form">
                            <div class="input-group">
                                <input type="email" name="email" class="form-control" placeholder="Introdu adresa ta de email" required="">
                                <button type="submit" class="btn-subscribe">
                                    <i class="bi bi-send"></i>
                                </button>
                            </div>
                            <div class="loading">Se încarcă</div>
                            <div class="error-message"></div>
                            <div class="sent-message">Mulțumim pentru abonare!</div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-lg-2 col-6">
                <div class="footer-links">
                    <h4>Companie</h4>
                    <ul>
                        <li><a href="#"><i class="bi bi-chevron-right"></i> Despre Noi</a></li>
<!--                        <li><a href="#"><i class="bi bi-chevron-right"></i> Blog</a></li>-->
                        <li><a href="#"><i class="bi bi-chevron-right"></i> Contact</a></li>
                    </ul>
                </div>
            </div>

<!--            <div class="col-lg-2 col-6">-->
<!--                <div class="footer-links">-->
<!--                    <h4>Soluții</h4>-->
<!--                    <ul>-->
<!--                        <li><a href="#"><i class="bi bi-chevron-right"></i> Strategie Digitală</a></li>-->
<!--                        <li><a href="#"><i class="bi bi-chevron-right"></i> Soluții AI</a></li>-->
<!--                        <li><a href="#"><i class="bi bi-chevron-right"></i> Securitate Cibernetică</a></li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->

            <div class="col-lg-2 col-6">
                <div class="footer-contact">
                    <h4>Contactează-ne</h4>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="bi bi-geo-alt"></i>
                        </div>
                        <div class="contact-info">
                            <p>Strada Academiei, numărul 14<br>București<br>România</p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="bi bi-telephone"></i>
                        </div>
                        <div class="contact-info">
                            <p>+40 773 198 267</p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="bi bi-envelope"></i>
                        </div>
                        <div class="contact-info">
                            <p>dir@gmail.com</p>
                        </div>
                    </div>

                    <div class="social-links">
                        <a href="#"><i class="bi bi-facebook"></i></a>
                        <a href="#"><i class="bi bi-twitter-x"></i></a>
                        <a href="#"><i class="bi bi-linkedin"></i></a>
                        <a href="#"><i class="bi bi-youtube"></i></a>
                        <a href="#"><i class="bi bi-github"></i></a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="footer-bottom">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="copyright">
                        <p>© <span>Drepturi de autor</span> <strong class="px-1 sitename">ITravel</strong> <span>Toate drepturile rezervate</span></p>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="footer-bottom-links">
                        <a th:href="@{/Privacy}">Politica de confidențialitate</a>
                        <a th:href="@{/Terms}">Termeni și condiții</a>
<!--                        <a href="#">Politica Cookie</a>-->
                    </div>
                    <div class="credits">
                    </div>
                </div>
            </div>
        </div>
    </div>

</footer>

<!-- Scroll Top -->
<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

<!-- Preloader -->
<!--<div id="preloader"></div>-->
<!-- Main JS File -->



<!-- Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Bine ai Revenit!</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <form th:action="@{/auth/login}" method="post">

                    <div class="mb-3">
                        <label class="form-label">Email sau Username</label>
                        <div class="input-group">
                            <input type="text" class="form-control" name="usernameOrEmail" placeholder="Enter your email or username" required>
                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Parolă</label>
                        <div class="input-group">
                            <input type="password" class="form-control" name="password" placeholder="Enter your password" required>
                            <span class="input-group-text"><i class="fas fa-eye"></i></span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-login w-100">Sign in</button>

                    <div class="register-link mt-3 text-center">
                        Nu ai un cont?
                        <a href="#" data-bs-toggle="modal" data-bs-target="#registerModal" data-bs-dismiss="modal">
                            Înregistrează-te acum
                        </a>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>


<!--register modal-->
<div class="modal fade" id="registerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Înregistrează-te</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/auth/register" method="post">

                    <div class="mb-3">
                        <label class="form-label">Nume</label>
                        <input type="text" class="form-control" name="username" placeholder="Your name" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Adresă de Email</label>
                        <input type="email" class="form-control" name="email" placeholder="name@example.com" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Parolă</label>
                        <input type="password" class="form-control" name="password_hash" placeholder="Password" required>
                    </div>
                    <div class="form-check mt-3">
                        <input class="form-check-input" type="checkbox" id="isGuide" name="isGuide" value="true">
                        <label class="form-check-label" for="isGuide">
                            Sunt ghid
                        </label>
                    </div>

                    <button type="submit" class="btn btn-login">Înregistrare</button>

                    <div class="divider mt-3"><span>sau sign up cu</span></div>

                    <div class="social-login mt-2">
                        <button type="button" class="btn btn-social">
                            <i class="fab fa-google"></i> Google
                        </button>
                        <button type="button" class="btn btn-social">
                            <i class="fab fa-facebook-f"></i> Facebook
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<!-- Avatar Select Modal -->
<div class="modal fade" id="avatarModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Choose Your Avatar</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <div class="row text-center">

                    <!-- 12 avataruri -->
                    <div class="col-3 mb-4" th:each="i : ${#numbers.sequence(1,12)}">
                        <label style="cursor:pointer; display:inline-block; position:relative;">
                            <input type="radio" name="avatar"
                                   th:value="'avatar' + ${i}"
                                   class="form-check-input"
                                   style="opacity:0; position:absolute; left:0; top:0; width:100%; height:100%; cursor:pointer;">

                            <img th:src="@{'https://api.dicebear.com/9.x/dylan/svg?seed=avatar' + ${i}}"
                                 class="rounded-circle border avatar-option"
                                 width="90" height="90">
                        </label>
                    </div>

                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="saveAvatarBtn">Save Avatar</button>
            </div>
        </div>
    </div>
</div>
<form id="avatarForm" th:action="@{/profile/avatar}" method="post" style="display:none">
    <input type="hidden" name="avatar" id="avatarValue"/>
    <!-- CSRF doar dacă există -->
    <input th:if="${_csrf != null}" type="hidden"
           th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
</form>
<!-- JS -->
<script>
function addDay() {
const container = document.getElementById('itinerariu-container');
const days = container.querySelectorAll('.itinerariu-day');
const firstDay = days[0];
const clone = firstDay.cloneNode(true);

// Index pentru următoarea zi
const newIndex = days.length;

// Reset values și update name
clone.querySelectorAll('input, textarea').forEach(field => {
field.value = '';

const nameAttr = field.getAttribute('name');
if (nameAttr) {
const newName = nameAttr.replace(/\d+/, newIndex);
field.setAttribute('name', newName);
}
});

container.appendChild(clone);
}
</script>

<script>
    (function () {
        function normalizePath(p) {
            if (!p) return '/';
            return (p.length > 1 && p.endsWith('/')) ? p.slice(0, -1) : p;
        }

        function setActiveNav() {
            const nav = document.querySelector('#navmenu');
            if (!nav) return;

            const path = normalizePath(window.location.pathname);

            const links = Array.from(nav.querySelectorAll('a'))
                .filter(a => a.getAttribute('href') && !a.getAttribute('href').startsWith('#'));

            // curăță active de pe toate
            links.forEach(a => a.classList.remove('active'));

            // match funcție: activează după pathname
            const rules = [
                { match: (p) => p === '/' || p.startsWith('/Itravel'), hrefEndsWith: '/Itravel' },
                { match: (p) => p.startsWith('/About'), hrefEndsWith: '/About' },
                { match: (p) => p.startsWith('/destinations'), hrefIncludes: '/destinations' },
                { match: (p) => p.startsWith('/Tours') || p.startsWith('/tours'), hrefEndsWith: '/Tours' },
                { match: (p) => p.startsWith('/trips'), hrefEndsWith: '/trips' },
                { match: (p) => p.startsWith('/journal'), hrefEndsWith: '/journal' }
            ];

            for (const r of rules) {
                if (!r.match(path)) continue;

                const found = links.find(a => {
                    const h = a.getAttribute('href');
                    if (r.hrefEndsWith) return h.endsWith(r.hrefEndsWith);
                    if (r.hrefIncludes) return h.includes(r.hrefIncludes);
                    return false;
                });

                if (found) found.classList.add('active');
                break;
            }
        }

        window.addEventListener('load', setActiveNav);
        document.addEventListener('scroll', setActiveNav);
    })();
</script>


<!--<script>-->
<!--    const filterButtons = document.querySelectorAll('.filter-pill');-->
<!--    const tours = document.querySelectorAll('#tour-container .tour-card');-->

<!--    filterButtons.forEach(button => {-->
<!--        button.addEventListener('click', function(event) {-->
<!--            event.preventDefault();-->
<!--            filterButtons.forEach(b => b.classList.remove('active'));-->
<!--            this.classList.add('active');-->

<!--            const filter = this.getAttribute('data-filter');-->

<!--            tours.forEach(tour => {-->
<!--                if (filter === '*') {-->
<!--                    tour.classList.remove('hidden');-->
<!--                } else {-->
<!--                    if (tour.classList.contains(filter)) {-->
<!--                        tour.classList.remove('hidden');-->
<!--                    } else {-->
<!--                        tour.classList.add('hidden');-->
<!--                    }-->
<!--                }-->
<!--            });-->
<!--        });-->
<!--    });-->
<!--</script>-->


<script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>

<script th:src="@{/vendor/imagesloaded/imagesloaded.pkgd.min.js}"></script>


<script th:src="@{/js/theme.js}"></script>
<script th:src="@{/js/chatBot.js}"></script>
<script th:src="@{/js/avatar.js}"></script>
<script th:src="@{/js/isotope.js}"></script>
<script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/main.js}"></script>
<script th:src="@{/js/dropdown.js}"></script>
<script th:src="@{/js/showCoin.js}"></script>



</body>
</html>